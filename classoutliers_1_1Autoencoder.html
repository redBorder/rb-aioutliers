<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>rb-aioutliers: outliers.Autoencoder Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">rb-aioutliers
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>outliers</b></li><li class="navelem"><a class="el" href="classoutliers_1_1Autoencoder.html">Autoencoder</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classoutliers_1_1Autoencoder-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">outliers.Autoencoder Class Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a29a74cb7b997381863864ba625bc8468"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a29a74cb7b997381863864ba625bc8468">__init__</a> (self, model_file, model_config_file)</td></tr>
<tr class="separator:a29a74cb7b997381863864ba625bc8468"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbfbe168624bb7cc5fd7920a3c9964cb"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#adbfbe168624bb7cc5fd7920a3c9964cb">check_existence</a> (self, model_file, model_config_file)</td></tr>
<tr class="separator:adbfbe168624bb7cc5fd7920a3c9964cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af96969ab82f965e7d8c922f33d8b5de5"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#af96969ab82f965e7d8c922f33d8b5de5">rescale</a> (self, data)</td></tr>
<tr class="separator:af96969ab82f965e7d8c922f33d8b5de5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a5eab72d2c327aa6ffaaa9fd4b52a13"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a1a5eab72d2c327aa6ffaaa9fd4b52a13">descale</a> (self, data)</td></tr>
<tr class="separator:a1a5eab72d2c327aa6ffaaa9fd4b52a13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2308dcbf4b0439528d47ae3119dd8102"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a2308dcbf4b0439528d47ae3119dd8102">model_loss</a> (self, y_true, y_pred, single_value=True)</td></tr>
<tr class="separator:a2308dcbf4b0439528d47ae3119dd8102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57087da3596c8513d7b990b69f1d033c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a57087da3596c8513d7b990b69f1d033c">slice</a> (self, data, index=None)</td></tr>
<tr class="separator:a57087da3596c8513d7b990b69f1d033c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac7ad0c75d52b0aa69820ce3a111b8e01"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#ac7ad0c75d52b0aa69820ce3a111b8e01">flatten</a> (self, data)</td></tr>
<tr class="separator:ac7ad0c75d52b0aa69820ce3a111b8e01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a303f609afc80ab269e862352c334c34c"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a303f609afc80ab269e862352c334c34c">calculate_predictions</a> (self, data)</td></tr>
<tr class="separator:a303f609afc80ab269e862352c334c34c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acaba3dbd799b7dbd92e4dcae0bde1b92"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#acaba3dbd799b7dbd92e4dcae0bde1b92">compute_json</a> (self, metric, raw_json)</td></tr>
<tr class="separator:acaba3dbd799b7dbd92e4dcae0bde1b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc879843f89b4ee6258ab47f21996897"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#adc879843f89b4ee6258ab47f21996897">granularity_from_dataframe</a> (self, dataframe)</td></tr>
<tr class="separator:adc879843f89b4ee6258ab47f21996897"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a570a8e718e1f2d7c4ef25f9d305e881a"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a570a8e718e1f2d7c4ef25f9d305e881a">input_json</a> (self, raw_json)</td></tr>
<tr class="separator:a570a8e718e1f2d7c4ef25f9d305e881a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98145ce7a2ae40814a54af6b1d3be19b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a98145ce7a2ae40814a54af6b1d3be19b">output_json</a> (self, metric, anomalies, predicted)</td></tr>
<tr class="separator:a98145ce7a2ae40814a54af6b1d3be19b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a4b7c0a57d9fa758f245a4508c42ae80e"><td class="memItemLeft" align="right" valign="top"><a id="a4b7c0a57d9fa758f245a4508c42ae80e" name="a4b7c0a57d9fa758f245a4508c42ae80e"></a>
def&#160;</td><td class="memItemRight" valign="bottom"><b>execute_prediction_model</b> (autoencoder, data, metric)</td></tr>
<tr class="separator:a4b7c0a57d9fa758f245a4508c42ae80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1845dcefe82cb1c4e066343e1fafe313"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classoutliers_1_1Autoencoder.html#a1845dcefe82cb1c4e066343e1fafe313">return_error</a> (error=&quot;error&quot;)</td></tr>
<tr class="separator:a1845dcefe82cb1c4e066343e1fafe313"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:aba372e5ce4fa077d7297f3d50f17d9f5"><td class="memItemLeft" align="right" valign="top"><a id="aba372e5ce4fa077d7297f3d50f17d9f5" name="aba372e5ce4fa077d7297f3d50f17d9f5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>metrics</b></td></tr>
<tr class="separator:aba372e5ce4fa077d7297f3d50f17d9f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bd6a9437dbb1d3792f8e8e3ff276407"><td class="memItemLeft" align="right" valign="top"><a id="a0bd6a9437dbb1d3792f8e8e3ff276407" name="a0bd6a9437dbb1d3792f8e8e3ff276407"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>timestamp</b></td></tr>
<tr class="separator:a0bd6a9437dbb1d3792f8e8e3ff276407"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad12bd64283eb388382605dc65439f87e"><td class="memItemLeft" align="right" valign="top"><a id="ad12bd64283eb388382605dc65439f87e" name="ad12bd64283eb388382605dc65439f87e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>columns</b></td></tr>
<tr class="separator:ad12bd64283eb388382605dc65439f87e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e10c789855ac9029fa45fbc03ea81b5"><td class="memItemLeft" align="right" valign="top"><a id="a6e10c789855ac9029fa45fbc03ea81b5" name="a6e10c789855ac9029fa45fbc03ea81b5"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>avg_loss</b></td></tr>
<tr class="separator:a6e10c789855ac9029fa45fbc03ea81b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9ec40c6143b9b79faa4e7d7b17e4110"><td class="memItemLeft" align="right" valign="top"><a id="ab9ec40c6143b9b79faa4e7d7b17e4110" name="ab9ec40c6143b9b79faa4e7d7b17e4110"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>std_loss</b></td></tr>
<tr class="separator:ab9ec40c6143b9b79faa4e7d7b17e4110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a028fedfb93845f4d33ee371db011b473"><td class="memItemLeft" align="right" valign="top"><a id="a028fedfb93845f4d33ee371db011b473" name="a028fedfb93845f4d33ee371db011b473"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>window_size</b></td></tr>
<tr class="separator:a028fedfb93845f4d33ee371db011b473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5ba5255861f9b0d2aff43c96e284cd4"><td class="memItemLeft" align="right" valign="top"><a id="ac5ba5255861f9b0d2aff43c96e284cd4" name="ac5ba5255861f9b0d2aff43c96e284cd4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>num_window</b></td></tr>
<tr class="separator:ac5ba5255861f9b0d2aff43c96e284cd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f957c00455cac9c96407e2f024596de"><td class="memItemLeft" align="right" valign="top"><a id="a0f957c00455cac9c96407e2f024596de" name="a0f957c00455cac9c96407e2f024596de"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>loss_mult_metric</b></td></tr>
<tr class="separator:a0f957c00455cac9c96407e2f024596de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34da5aeb3031b00395fc840b735c840e"><td class="memItemLeft" align="right" valign="top"><a id="a34da5aeb3031b00395fc840b735c840e" name="a34da5aeb3031b00395fc840b735c840e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>loss_mult_minute</b></td></tr>
<tr class="separator:a34da5aeb3031b00395fc840b735c840e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a357ba3f4acb1fabea43aa6c2cc950830"><td class="memItemLeft" align="right" valign="top"><a id="a357ba3f4acb1fabea43aa6c2cc950830" name="a357ba3f4acb1fabea43aa6c2cc950830"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>model</b></td></tr>
<tr class="separator:a357ba3f4acb1fabea43aa6c2cc950830"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Autoencoder class for anomaly detection.

Args:
    model_file (str): Path to model .keras file.
    model_config (dict): Model parameters (metrics, timestamps, etc...)
</pre> </div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a29a74cb7b997381863864ba625bc8468" name="a29a74cb7b997381863864ba625bc8468"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29a74cb7b997381863864ba625bc8468">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model_config_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Initializes the Autoencoder model and defines constants.

Args:
    model_file (str): Path to model .keras file.
    model_config_file (str): Path to the model config, including:
        metrics (list): Names of the metrics used by the module.
        timestamp (list): Names of the timestamp columns used by the module.
        avg_loss (float): Average loss of the model.
        std_loss (float): Standard deviation of the loss of the model.
        window_size (int): Number of entries the model will put together in a 'window'.
        num_window (int): Number of windows the model will put together in each slice.
        loss_mult_metric (float): Extra penalty in the loss function for guessing wrong metrics.
        loss_mult_minute (float): Extra penalty in the loss function for guessing wrong
          'minute' field.
</pre> 
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a303f609afc80ab269e862352c334c34c" name="a303f609afc80ab269e862352c334c34c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a303f609afc80ab269e862352c334c34c">&#9670;&#160;</a></span>calculate_predictions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.calculate_predictions </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Proccesses the data, calculates the prediction and its loss.

Args:
    data (numpy.ndarray): 2D numpy array with the relevant data.
Returns:
    predicted (numpy.ndarray): predicted data
    anomalies (numpy.ndarray): anomalies detected
    loss (numpy.ndarray): loss function for each entry
</pre> 
</div>
</div>
<a id="adbfbe168624bb7cc5fd7920a3c9964cb" name="adbfbe168624bb7cc5fd7920a3c9964cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbfbe168624bb7cc5fd7920a3c9964cb">&#9670;&#160;</a></span>check_existence()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.check_existence </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model_file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>model_config_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Check existence of model files and copy them if missing.

This function checks if the provided `model_file` and `model_config_file` exist in their
respective paths. If they don't exist, it raises an error.

Args:
    model_file (str): Path to the target model file.
        - The full path to the model file you want to check and potentially copy.
    model_config_file (str): Path to the target model configuration file.
        - The full path to the model configuration file you want to check and potentially copy.
</pre> 
</div>
</div>
<a id="acaba3dbd799b7dbd92e4dcae0bde1b92" name="acaba3dbd799b7dbd92e4dcae0bde1b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acaba3dbd799b7dbd92e4dcae0bde1b92">&#9670;&#160;</a></span>compute_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.compute_json </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>raw_json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Main method used for anomaly detection.

Make the model process Json data and output to RedBorder prediction Json format.
It includes the prediction for each timestamp and the anomalies detected.

Args:
    metric (string): the name of field being analyzed.
    raw_json (dict): deserialized Json druid response with the data.

Returns:
    (dict): deserialized Json with the anomalies and predictions for the data with RedBorder
      prediction Json format.
</pre> 
</div>
</div>
<a id="a1a5eab72d2c327aa6ffaaa9fd4b52a13" name="a1a5eab72d2c327aa6ffaaa9fd4b52a13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a5eab72d2c327aa6ffaaa9fd4b52a13">&#9670;&#160;</a></span>descale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.descale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Descale data to original scale.

Args:
    data (numpy.ndarray): Input data as a numpy array.

Returns:
    (numpy.ndarray): Descaled data as a numpy array.
</pre> 
</div>
</div>
<a id="ac7ad0c75d52b0aa69820ce3a111b8e01" name="ac7ad0c75d52b0aa69820ce3a111b8e01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac7ad0c75d52b0aa69820ce3a111b8e01">&#9670;&#160;</a></span>flatten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.flatten </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Flatten a 3D numpy array used by the model into a human-readable 2D numpy array.
Args:
    data (numpy.ndarray): 3D numpy array.
Returns:
    (numpy.ndarray): 2D numpy array with the natural format of the data.
</pre> 
</div>
</div>
<a id="adc879843f89b4ee6258ab47f21996897" name="adc879843f89b4ee6258ab47f21996897"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc879843f89b4ee6258ab47f21996897">&#9670;&#160;</a></span>granularity_from_dataframe()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.granularity_from_dataframe </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dataframe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Extract the granularity from a dataframe. The granularity is suposed to be the difference
between successive timestamps.

Args:
    dataframe (pandas.DataFrame): Dataframe with timestamp column

Returns:
    time_diffs (pandas.Series): Series with the estimated Granularity of the dataframe.
</pre> 
</div>
</div>
<a id="a570a8e718e1f2d7c4ef25f9d305e881a" name="a570a8e718e1f2d7c4ef25f9d305e881a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a570a8e718e1f2d7c4ef25f9d305e881a">&#9670;&#160;</a></span>input_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.input_json </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>raw_json</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform Json data into numpy.ndarray readable by the model.
Also returns the timestamps for each entry.

Args:
    raw_json (dict): deserialized Json druid response with the data.

Returns:
    data (numpy.ndarray): transformed data.
    timestamps (pandas.Series): pandas series with the timestamp of each entry.
</pre> 
</div>
</div>
<a id="a2308dcbf4b0439528d47ae3119dd8102" name="a2308dcbf4b0439528d47ae3119dd8102"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2308dcbf4b0439528d47ae3119dd8102">&#9670;&#160;</a></span>model_loss()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.model_loss </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_true</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>y_pred</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>single_value</em> = <code>True</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Calculate the weighted loss for the model.
Compares the input with boolean-valued tensors IS_METRIC and IS_MINUTE.
Where IS_METRIC is true, the value of the input is multiplied by mult1,
where IS_MINUTE is true, the value of the input is multiplied by mult2,
otherwise, the value is left unchanged.
Then, the difference between both tensors is evaluated and a log_cosh loss
is applied.

Args:
    y_true (tf.Tensor): True target values.
    y_pred (tf.Tensor): Predicted values.
    single_value (bool): Set to False to return a 3D array with the loss on each timestamp.

Returns:
    (tf.Tensor): Weighted loss value or a 3D loss array.
</pre> 
</div>
</div>
<a id="a98145ce7a2ae40814a54af6b1d3be19b" name="a98145ce7a2ae40814a54af6b1d3be19b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98145ce7a2ae40814a54af6b1d3be19b">&#9670;&#160;</a></span>output_json()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.output_json </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>metric</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anomalies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>predicted</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Changes the format of the model's output to a JSON compatible with redBorder.

Args:
    metric (string): the name of field being analyzed.
    anomalies (pandas.DataFrame): anomalies detected by the model.
    predicted (pandas.DataFrame): predictions made by the model.

Returns:
    (dict): deserialized Json with the anomalies and predictions for the data with RedBorder prediction
      Json format.
</pre> 
</div>
</div>
<a id="af96969ab82f965e7d8c922f33d8b5de5" name="af96969ab82f965e7d8c922f33d8b5de5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af96969ab82f965e7d8c922f33d8b5de5">&#9670;&#160;</a></span>rescale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.rescale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Rescale data between 0-1.
For a metric x, the rescaling function is tanh(ln(x+1)/32).
For the minute field, it is rescaled by dividing the number between 1440.

Args:
    data (numpy.ndarray): Input data as a numpy array.

Returns:
    (numpy.ndarray): Rescaled data as a numpy array.
</pre> 
</div>
</div>
<a id="a1845dcefe82cb1c4e066343e1fafe313" name="a1845dcefe82cb1c4e066343e1fafe313"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1845dcefe82cb1c4e066343e1fafe313">&#9670;&#160;</a></span>return_error()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.return_error </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>error</em> = <code>&quot;error&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns an adequate formatted JSON for whenever there is an error.

Args:
    error (string): message detailing what type of error has been fired.
</pre> 
</div>
</div>
<a id="a57087da3596c8513d7b990b69f1d033c" name="a57087da3596c8513d7b990b69f1d033c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a57087da3596c8513d7b990b69f1d033c">&#9670;&#160;</a></span>slice()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def outliers.Autoencoder.slice </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>index</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Transform a 2D numpy array into a 3D array readable by the model, with overlapping slices.

Args:
    data (numpy.ndarray): 2D numpy array with the data to prepare.
    index (list or numpy.ndarray): Index in case you want only some of the slices returned.

Returns:
    (numpy.ndarray): 3D numpy array that can be processed by the model.
</pre> 
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>resources/src/ai/outliers.py</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
